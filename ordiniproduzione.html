<html>
<head>
<title>Ordini di Produzione</title>
<meta charset="utf-8">
<meta name="description" content="Gestione Avanzamento Produzione"> <!--descrizione sintetica viualizzata nei motori di ricerca-->
<meta name="keywords" content="">
<meta name="robots" content="all"> <!--indica allo spider quali pagine indicizzare -->
<meta name="rating" content="general"> <!--decrive il tipo di pubblico (general, mature, restricted, 14years, safe for kids) -->
<meta http-equiv="expires" content="0"> <!--fa scaricare al browser sempre la copia aggiornata-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<link rel="stylesheet" href="css/style-3.css" type="text/css">
<link rel="stylesheet" href="css/style-container-3.css" type="text/css">
<!--
<link href="http://fonts.googleapis.com/css?family=Bitter&subset=latin" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css/nestedsidemenu.css" />
-->
</head>
<body onload="caricamento()">
	<div class="grid-container">
			<div class="colonna0" >
				<img class="menu-icon" src="img/back_01.png" onclick="var x = document.getElementById('colonna1');if (x.style.display === 'none') {   x.style.display = 'block'; $('.menu-icon').attr('src','img/back_01.png');} else {x.style.display = 'none'; $('.menu-icon').attr('src','img/forward_01.png');}"/>
			<!--</div>-->
			<div class="colonna1" id="colonna1">
<div class="header">
		<!--<div class="menu-trigger" style="float:left">
				<button type="button" onclick="aprichiudimenu()">Menu</button>
			</div>-->
		<div class="logo">
		<img src="img/exacta-logo.png" />
	</div>
	<div class="title">
	Gestione Avanzamento Produzione
	</div>
</div>
<div style="clear:both;"></div>
<!--<div class="funzioni">-->
	<div id="sidebar">
			<div class="menu nestedsidemenu">
				<!--<div class="closeButton"></div>				
				<div class="nestedsidemenu">
					<br style="clear: left" />
				</div>-->
			</div>
	</div>
		<!--<div class="menuButton"></div>-->
		</div>
		</div>	
    <div id="main"  >
        <div id="content">
	<div class="corpoLista" id="corpoLista" >
		<div class="corpoListaHeader">
			Elenco Ordini di produzione
		</div>
		<form id="myForm" action="ordiniproduzione.php" method="POST"> 
				<div class="nav">
						<input onclick="pagination('first')" id="exit" type="button" value="<<" />
						<input onclick="pagination('prev')" id="exit" type="button" value="<" />
						<span id="pagsup" type="text" name="pagsup" readonly="readonly" ></span>
						<input onclick="pagination('next')" id="exit" type="button" value=">" />
						<input onclick="pagination('last')" id="exit" type="button" value=">>" />
					</div>
					<div class="comandi">
							<!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
							<div class=allinea>
							<!--<button onclick="invocaNuovo()">Nuovo</button>-->
							</div>
							<div class=allinea>
							<button onclick="aggiornaLista()">Aggiorna</button>
							</div>
							<div class=allinea>
							<button onclick="invocaFiltro()">Ricerca</button>
							</div>
							<!--<div class=allinea>
							<button onclick="invocaAggiornamentoCommesse()">Aggiornamento Commesse</button>
							</div>-->
							<div class=allinea>
							<a id="cmdReport" href="ordiniproduzione.php?op=report&pag=1&npag=1&nrighe=1000&filtro=&ordinamento="><img src="img/excel.jpg" width="32px" height="32px" alt="Scarica Report Excel"/></a>
							</div>
						</div>
						<div class="lista">
				<table id='my_table' class='tabella' cellspacing='0' cellpadding='0'>
				<thead>
				<tr>
				<th class="sorting" id="th_idop" onclick="setOrdinamento('idop')">ID Ordine</th>
				<th class="sorting" id="th_data" onclick="setOrdinamento('data')">Data</th>
				<th class="sorting" id="th_idarticolo" onclick="setOrdinamento('idarticolo')">Codice Articolo</th>
				<th class="sorting" id="th_qta_richiesta" onclick="setOrdinamento('qta_richiesta')">Qtà da produrre</th>
				<th class="sorting" id="th_qta_prodotta" onclick="setOrdinamento('qta_prodotta')">Qtà prodotta</th>
				</tr>
				</thead>
					<tbody>
					<!-- IL BODY E' INIZIALMENTE VUOTO -->
					</tbody>
				</table>
			</div>
			<br/>
			<div class="nav">
				<input onclick="pagination('first')" id="exit" type="button" value="<<" />
				<input onclick="pagination('prev')" id="exit" type="button" value="<" />
				<span id="paginf" type="text" name="paginf" readonly="readonly" ></span>
						<input id="pag" type="hidden" name="pag" readonly="readonly" value="1" />
						<input onclick="pagination('next')" id="exit" type="button" value=">" />
				<input onclick="pagination('last')" id="exit" type="button" value=">>" />
				<input id="op" type="hidden" name="op" value="list" />
				<input id="nrighe" type="hidden" name="nrighe" value="10" />
				<input id="npag" type="hidden" name="npag" value="0" />
				<input id="ordinamento" type="hidden" name="ordinamento" value="" />
			</div>
			<div class="comandi">
				<!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
				<div class=allinea>
				<!--<button onclick="invocaNuovo()">Nuovo</button>-->
				</div>
				<div class=allinea>
				<button onclick="aggiornaLista()">Aggiorna</button>
				</div>
				<div class=allinea>
                <button onclick="invocaFiltro()">Ricerca</button>
				</div>
				<!--<div class=allinea>
                <button onclick="invocaAggiornamentoCommesse()">Aggiornamento Commesse</button>
				</div>-->
				<div class=allinea>
				<a id="cmdReport" href="ordiniproduzione.php?op=report&pag=1&npag=1&nrighe=1000&filtro=&ordinamento="><img src="img/excel.jpg" width="32px" height="32px" alt="Scarica Report Excel"/></a>
				</div>
			</div>
			<div class="filtro">
				<label id="opFiltroLabel">Filtro:</label>
				<input id="valFiltro" type="text" name="filtro" readonly="readonly" value="" />
            </div>
			<!--<div class="comando2">
				<input id="op2" type="hidden" name="op2" readonly="readonly" value="" />
            </div>-->
		</form>  
		<div class="esito" >
			<span id="resultmyForm"></span>
		</div>
	</div>
<!-- filtro -->
	<div class="corpoFiltro" id="corpoFiltro" style="display:none">
		<div class="corpoFiltroHeader">
		Criteri di ricerca Ordini di produzione  
		</div>
		<form id="myFormFiltro" > 
			<div class="record">
				<table>
					<tr>
                        <td>ID Ordine</td>
						<td><select class="operatore" type="text" name="idop_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
						<td><input type="text" name="idop" /></td>
					</tr>
					<tr>
					<td>Data</td>
						<td><select class="operatore" type="text" name="data_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="data" /></td>
					</tr>
					<tr>
					<td>Codice Articolo</td>
						<td><select class="operatore" type="text" name="idarticolo_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="idarticolo" /></td>
					</tr>
					<tr>
					<td>Qtà da produrre</td>
						<td><select class="operatore" type="text" name="qta_richiesta_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="number" name="qta_richiesta" /></td>
					</tr>
					<tr>
					<td>Qtà prodotta</td>
						<td><select class="operatore" type="text" name="qta_prodotta_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="number" name="qta_prodotta" /></td>
					</tr>
				</table>
			</div>
			<div class="comandi">
				
					<button onclick="aggiornaLista(aggiornaPrmFiltroExport(applicaFiltro()))">Applica</button>
					<button onclick="chiudiFiltro()">Esci</button>
					<button onClick="this.form.reset();" >Ripristina</button>
				</div>

		</form>  

	</div>    
<!-- -->    
    <div class="corpoEdit" id="corpoEdit" style="display:none">
		<div class="corpoEditHeader">
			Ordine di produzione  
		</div>
		<form id="myFormEdit" action="ordiniproduzione.php" method="POST"> 
			<div class="record">
				<table>
					<tr>
					<td>Codice Ordine</td><td><input type="text" name="idop" /></td>
					</tr>
					<tr>
					<td>Data</td><td><input type="text" name="data" /></td>
					</tr>
					<tr>
					<td>Codice Articolo</td><td><input id="idarticolo" type="text" name="idarticolo" /></td>
					</tr>
					<tr>
					<td>Qtà richiesta</td><td><input id="qta_richiesta" type="number" name="qta_richiesta" /></td>
					</tr>
					<tr>
					<td>Qtà prodotta</td><td><input type="number" name="qta_prodotta" /></td>
					</tr>
				</table>
			</div>
			<div class="comandi">
				<!--<input id="submyFormEdit" type="submit" value="Invia" />-->
				<!--<button onclick="deleteRecord()">Elimina</button>-->
				<button onclick="cambiaForm()">Esci</button>
			</div>
			<div class="modo">
				<label id="opEditLabel">Modo:</label>
				<input id="opEdit"  type="text" name="op" readonly="readonly" value="insert" />
			</div>
		</form>  
		<div class="esito" >
			<span id="resultmyFormEdit"></span>
		</div>
		<div class="corpoNascosto"style="display:none">
			<form id="myFormHiddenOP" action="ordiniproduzione.php" method="POST">
				<input id="idop" type="text" name="idop" value="" />
				<input id="op" type="hidden" name="op" value="get" />
            </form>
			<form id="myFormHiddenCommesse" action="commesse.php" method="POST">
					<input type="text" name="id_order" />
					<input type="text" name="descrizione" />
					<input type="text" name="data_inizio" />
					<input type="text" name="data_fine" />
					<input type="text" name="prodotto" />
					<input type="number" name="qta" />

                <input id="idop4" type="text" name="idop" value="" />
				<input id="op4" type="hidden" name="op" value="get" />
            </form>
			<form id="myFormHiddenOrdiniClienti" action="ordiniclienti.php" method="POST">
				<input id="idPK1" type="text" name="idop" value="" />
				<input id="valFiltro1" type="hidden" name="filtro" readonly="readonly" value="" />
				<input type="hidden" name="nrighe" value="100" />
				<input type="hidden" name="npag" value="1" />
				<input type="hidden" name="pag" value="1" />
				<input id="op1" type="hidden" name="op" value="list" />
			</form>
			<form id="myFormHiddenMateriali" action="materialixarticolo.php" method="POST">
				<input id="idarticolo" type="text" name="idarticolo" value="" />
				<input id="valFiltro2" type="text" name="filtro" readonly="readonly" value="" />
				<input id="qta_richiesta2" type="text" name="qta_richiesta" readonly="readonly" value="" />
				<input type="hidden" name="nrighe" value="100" />
				<input type="hidden" name="npag" value="1" />
				<input type="hidden" name="pag" value="1" />
				<input id="op2" type="hidden" name="op" value="listQtaRichiesta" />
			</form>
			<form id="myFormHiddenLavorazioni" action="fasixarticolo.php" method="POST">
				<input id="idarticolo" type="text" name="idarticolo" value="" />
				<input id="valFiltro3" type="text" name="filtro" readonly="readonly" value="" />
				<input type="hidden" name="nrighe" value="100" />
				<input type="hidden" name="npag" value="1" />
				<input type="hidden" name="pag" value="1" />
				<input id="op3" type="hidden" name="op" value="list" />
			</form>
		</div>
<!-- elenco tab-->
<div class="tab">
	<button class="tablinks" onclick="openTab(event, 'corpoLista1')">Commesse</button>
	<button class="tablinks" onclick="openTab(event, 'corpoLista2')">Materiali</button>
	<button class="tablinks" onclick="openTab(event, 'corpoLista3')">Fasi</button>
</div>
<!-- form commesse -->
<div class="corpoLista tabcontent" id="corpoLista1" >
    <div class="corpoListaHeader">
        Elenco Ordini clienti
    </div>
    <form id="myFormOrdiniClienti" action="ordiniclienti.php" method="POST"> 
        <div class="lista">
            <table  id='my_table1' class='tabella' cellspacing='0' cellpadding='0'>
            <thead>
            <tr>
            <th>Codice Cliente</th><th>Ordine Cliente</th><th>Qtà da produrre</th><th>Data consegna</th>
            </tr>
            </thead>
                <tbody>
                <!-- IL BODY E' INIZIALMENTE VUOTO -->
                </tbody>
            </table>
        </div>
        <br/>
        <div class="nav">
        </div>
        <div class="comandi">
            <!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
            <div class=allinea>
            <!--<button onclick="lanciaProduzione()">Lancia in Produzione</button>-->
            </div>
        </div>
    </form>  
    <div class="esito" >
        <span id="resultmyFormOrdiniClienti"></span>
    </div>
</div>
<!-- -->
<div style="clear:both"></div>
<!-- form materiali -->
<div class="corpoLista tabcontent" id="corpoLista2" >
    <div class="corpoListaHeader">
        Elenco Materiali
    </div>
    <form id="myFormMateriali" action="materialixarticolo.php" method="POST"> 
        <div class="lista">
            <table  id='my_table2' class='tabella' cellspacing='0' cellpadding='0'>
            <thead>
            <tr>
            <th>Codice Materiale</th><th>Descrizione</th><th>Qtà Totale prevista</th>
            </tr>
            </thead>
                <tbody>
                <!-- IL BODY E' INIZIALMENTE VUOTO -->
                </tbody>
            </table>
        </div>
        <br/>
        <div class="nav">
        </div>
        <div class="comandi">
            <!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
            <div class=allinea>
            <!--<button onclick="aggiornaLista()">Aggiorna</button>-->
            </div>
        </div>
    </form>  
    <div class="esito" >
        <span id="resultmyFormMateriali"></span>
    </div>
</div>
<!---->
<div style="clear:both"></div>
<!-- form lavorazioni -->
<div class="corpoLista tabcontent" id="corpoLista3" >
    <div class="corpoListaHeader">
        Elenco Lavorazioni da eseguire
    </div>
    <form id="myFormLavorazioni" action="fasixarticolo.php" method="POST"> 
        <div class="lista">
            <table  id='my_table3' class='tabella' cellspacing='0' cellpadding='0'>
            <thead>
            <tr>
            <th>Fase</th><th>Lavorazione</th><th>Risorsa</th><th>Descrizione</th><th>H. Attr. previste</th><th>T. Ciclo. previsto (sec)</th><th>Note</th>
            </tr>
            </thead>
                <tbody>
                <!-- IL BODY E' INIZIALMENTE VUOTO -->
                </tbody>
            </table>
        </div>
        <br/>
        <div class="nav">
        </div>
        <div class="comandi">
            <!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
            <div class=allinea>
            <!--<button onclick="aggiornaLista()">Aggiorna</button>-->
            </div>
        </div>
    </form>  
    <div class="esito" >
        <span id="resultmyFormLavorazioni"></span>
    </div>
</div>
<!---->

    </div>
	</div>
	</div>
</div>
<div style="clear:both"></div>
<!--<script src="script/jquery-1.12.4.min.js" type="text/javascript"></script>-->
<script type="text/javascript" src="script/jquery-1.9.1.js"></script>
<script src="script/myScript.js" type="text/javascript"></script>
<script type="text/javascript" src="script/numberFormat154.js"></script>
<script type="text/javascript">

$(document).ready(function() {
	$('.menuButton').click(function()
	{
        $('#sidebar').animate({"left":"0px"}, 10);
    });

	$('.closeButton').click(function()
	{
        $('#sidebar').animate({"left":"-236px"}, 10);
	});
	
	costruisciMenu();

});

	elencoCampiLista= {
					"idop":{"caption":"ID OP","tipo":"T","sort":""},
					"data" : {"caption":"Data","tipo":"D","sort":""}, 
					 "idarticolo" : {"caption":"Articolo","tipo":"T","sort":""}, 
					 "qta_richiesta" :{"caption": "Qta richiesta","tipo":"N","sort":""}, 
					 "qta_prodotta" : {"caption":"Qta prodotta","tipo":"N","sort":""} 
				};

	elencoCampiListaOP=elencoCampiLista;


	
function caricamento(){
		//------chiudimenu();
	};

</script>
	
<script type='text/javascript'>

function deleteRecord(){
$("#opEdit").val("delete");
	richiestaDati("myFormEdit");

}



$("#sub").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myForm").submit( function() {
  return false;
});


$("#submyFormEdit").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myFormEdit").submit( function() {
  return false;
});


$("#submyFormFiltro").click( function() {
	return false;
});
 
$("#myFormFiltro").submit( function() {
  return false;
});


function invocaEdit(id){
	$("#idop").val(id);
	$("#opEdit").val("edit");
	
	cambiaForm();
    richiestaDati("myFormHiddenOP",operazioniAusiliarieEdit);
};

function invocaNuovo(){

    return;

	$("#idop").val("");
	$("#opEdit").val("insert");
	
	cambiaForm();
	richiestaDati("myFormHiddenOP");
	
};

elencoCampiListaOrdiniClienti= {
					 "idcliente" : {"caption":"Codice Cliente","tipo":"T"}, "idordine_cliente" : {"caption":"Ordine Cliente","tipo":"T"}, "qta_richiesta":{"caption":"Qtà da produrre","tipo":"N"},
					 "data_consegna_prevista" : {"caption":"Data Consegna","tipo":"D"}
				};

elencoCampiListaMateriali= {
					 "idmateriale" : {"caption":"Codice Materiale","tipo":"T"}, "descrizione" : {"caption":"Descrizione","tipo":"T"}, "qta_richiesta":{"caption":"Qtà Totale","tipo":"N"},
					 
				};

elencoCampiListaLavorazioni= {
					 "idfase" : {"caption":"Fase","tipo":"T"}, "descr_fase" : {"caption":"Descrizione","tipo":"T"}, "idrisorsa":{"caption":"Risorsa","tipo":"T"},
                     "descr_risorsa" : {"caption":"Descrizione","tipo":"T"},
                     "tempo_attrezzaggio_h" : {"caption":"T attrezz. previsto","tipo":"N"},
                     "tempo_ciclo_s" : {"caption":"T ciclo. previsto","tipo":"N"},
                     "note" : {"caption":"Note","tipo":"T"},

				};


function operazioniAusiliarieEdit()
{
	id=$("#idop").val();
    console.log("operazioniAusiliarieEdit("+id+")");

    var filtro="idop='"+id+"'";
    $("#valFiltro1").val(filtro);
    $("#my_table1 tbody tr:nth-child(n+1)").remove();
    $("#my_table2 tbody tr:nth-child(n+1)").remove();
    $("#my_table3 tbody tr:nth-child(n+1)").remove();
    $("#op1").val("listeComplete");
	richiestaDati2K("myFormHiddenOrdiniClienti",elencoCampiListaOrdiniClienti,operazioniAusiliarieEdit2);
    
}    
    function operazioniAusiliarieEdit2()
{
    console.log("operazioniAusiliarieEdit2()");

    var filtro="idarticolo='"+$("#idarticolo").val()+"'";
    $("#valFiltro2").val(filtro);
    var qta=$("#qta_richiesta").val();
    $("#qta_richiesta2").val(qta);
    $("#op2").val("listQtaRichiesta");
    
    $("#my_table2 tbody tr:nth-child(n+1)").remove();
	richiestaDati2K("myFormHiddenMateriali",elencoCampiListaMateriali,operazioniAusiliarieEdit3);
	
}    
    function operazioniAusiliarieEdit3()
{
    console.log("operazioniAusiliarieEdit3()");

    var filtro="idarticolo='"+$("#idarticolo").val()+"'";
    $("#valFiltro3").val(filtro);
    $("#op3").val("list");
    
    $("#my_table3 tbody tr:nth-child(n+1)").remove();
	richiestaDati2K("myFormHiddenLavorazioni",elencoCampiListaLavorazioni);
	
}



function invocaLancioProduzione(id){
    // in id trovo idordine_cliente e idop
    var ids=id.split(";");
    var idordine_cliente=ids[0];
    var idop=ids[1];

    // creare un record commessa aaaa-idop-idordine, data_consegna, idarticolo, qta
    // creare un record macchine x commessa: aprire macchinexcommessa.html
    //$("#op2").val("aggiorna");
};

function lanciaProduzione() {
    return;
}

function aggiornaLista(){
$("#my_table tbody tr:nth-child(n+1)").remove();
$("#npag").val(0);
	$("#op").val("list");
	richiestaDati("myForm",elencoCampiListaOP,impostaNpag);
	
};
function scaricaReport(){
	$("#op").val("report");
	richiestaDati("myForm");
};




function invocaFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function chiudiFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function cambiaForm(){
            $("#corpoEdit").toggle();
            $("#corpoLista").toggle();

};
$(document).ready(function(){
	aggiornaLista();
});

function richiestaDati2K(myFormName,elencoCampiLista,callback){
    console.log("richiestaDati2K "+myFormName);

    var elencoCampiLista= (typeof arguments[1] == 'undefined')?null:arguments[1];
	 $.post( $("#"+myFormName).attr("action"),
         $("#"+myFormName+" :input").serializeArray(),
         function(risposta){
            console.log("richiestaDati2K "+myFormName+" risposta");

            if (risposta.substr(0,1)=="{" || risposta.substr(0,1)<' ') {
                var info = $.parseJSON(risposta);
                $esito=info["esito"];
                $op=info["richiesta"];
                $dati=info["dati"];
                $pagina=info["pagina"];
                $pagine=info["pagine"];
                if ($esito==true) {
                    switch($op) {
                        case "listeComplete":
                        var myArrCompleto = $.parseJSON($dati);
                        var myFormList=myFormName.replace("Hidden", "");
                            myArr=myArrCompleto["ordini_clienti"];
                            // -- da myFormHiddenName ricavare myFormName e ricavare nome table contenuta nella form
                            var myFormList="myFormOrdiniClienti";
                            var myTableId=$( "#"+myFormList ).find( "table" ).attr("id");
                            var myAction=myFormList.replace("myForm","lista");
                            scorriRecord2K(myArr,myTableId,myAction,elencoCampiListaOrdiniClienti );

                            myArr=myArrCompleto["materiali"];
                            // -- da myFormHiddenName ricavare myFormName e ricavare nome table contenuta nella form
                            var myFormList="myFormMateriali";
                            var myTableId=$( "#"+myFormList ).find( "table" ).attr("id");
                            var myAction=myFormList.replace("myForm","lista");
                            scorriRecord2K(myArr,myTableId,myAction,elencoCampiListaMateriali );

                            myArr=myArrCompleto["lavorazioni"];
                            // -- da myFormHiddenName ricavare myFormName e ricavare nome table contenuta nella form
                            var myFormList="myFormLavorazioni";
                            var myTableId=$( "#"+myFormList ).find( "table" ).attr("id");
                            var myAction=myFormList.replace("myForm","lista");
                            scorriRecord2K(myArr,myTableId,myAction,elencoCampiListaLavorazioni );

                            break;
                        case "list":
                        case "listQtaRichiesta":
                            $("#pag").val($pagina);
                            $("#npag").val($pagine);
                            //var myAction="invocaEdit";
                            
                            var myArr = $.parseJSON($dati);
                            
                            // -- da myFormHiddenName ricavare myFormName e ricavare nome table contenuta nella form
                            var myFormList=myFormName.replace("Hidden", "");
                            var myTableId=$( "#"+myFormList ).find( "table" ).attr("id");
                            var myAction=myFormList.replace("myForm","lista");
                            scorriRecord2K(myArr,myTableId,myAction,elencoCampiLista);
                            break;
                        case "get":
                            var myArr = $.parseJSON($dati);
                            scorriRecordGet(myArr,"myFormEdit");
                            break;
                        default: 
                            $("#result").html($dati);
                            //clearInput(myFormName);
                    }
                }
                else
                    $("#result"+myFormName).html($dati);

                    // invoca myFunction
                    if (callback && typeof callback === 'function') 
                        callback();
            }
		    else {
			    $("#result"+myFormName).html(risposta);
			}
            console.log("richiestaDati2K "+myFormName+" fine risposta");
		 });

};	


function scorriRecord2K(arr,id_table,myAction){
	var elencoCampiLista= (typeof arguments[3] == 'undefined')?null:arguments[3];
	for (var i = 0; i < arr.length; i++){
		var obj = arr[i];
		aggiungiRiga2K(obj,id_table,myAction,elencoCampiLista);
		
	}
}

function aggiungiRiga2K(objRec,id_table,myAction){
	var elencoCampiLista= (typeof arguments[3] == 'undefined')?null:arguments[3];
	if (elencoCampiLista != null)
		obj=elencoCampiLista;
	else
		obj=objRec;
     //var table = document.getElementById(id_table);
     var tbody = $("#"+id_table).children("tbody");//table.getElementsByTagName('tbody')[0];
     //var colonne = table.getElementsByTagName('th').length;	
     var tr = document.createElement('tr');
	//var primo=true;
	var idValue="";
	var idValue1="";
	var idValue2="";
    if (myAction == 'listaOrdiniClienti') {
            key = "idordine_cliente"; idValue1=objRec[key];
            key = "idop"; idValue2=objRec[key];
	}
	for (var key in obj){
		var attrName = key;
		var attrValue = objRec[key];

			var attrName = key;
			var attrValue = formatValue(objRec[key],key,elencoCampiLista);
			var attrType = myFieldType(key,elencoCampiLista);

				var td = document.createElement('td');
				var tx = document.createTextNode(attrValue);
				td.appendChild(tx);

                var att = document.createAttribute("name");       
			    att.value = attrName;                
			    td.setAttributeNode(att); 
			
				var att = document.createAttribute("class");       
				if (attrType == "N") {
					att.value = "campo_numerico";                
				}
				else {
					att.value = "campo_testo";                
				}
				td.setAttributeNode(att); 

				tr.appendChild(td);
		
	}

	if (myAction == 'listaOrdiniClienti') {
		var att = document.createAttribute("onclick");       
		att.value = "invocaLancioProduzione('"+idValue1+";"+idValue2+"')";                
		tr.setAttributeNode(att); 

		var att = document.createAttribute("data-xref");       // Create a "data-xref" attribute
		att.value = myAction +"("+idValue+")";                // Set the value of the attribute
		tr.setAttributeNode(att); 
	}

	tbody.append(tr);

};

/*
var btn = document.getElementById("listboxCommessa");

if (btn.addEventListener)
    btn.addEventListener("change", caricaCommessa, false);
else if (btn.attachEvent)
    btn.attachEvent("onchange", caricaCommessa);
*/
var mappa = new Array();
mappa["id_order"]="id_order";mappa["prodotto"]="product";mappa["qta"]="requested_pieces";
mappa["data_inizio"]="planned_start_date";mappa["data_fine"]="planned_end_date";


/*
jQuery( function($) {
        $('tbody tr[data-href]').addClass('clickable').click( function() {
            $("#corpoEdit").toggle();
            $("#corpoLista").toggle();
        }).find('a').hover( function() {
            $(this).parents('tr').unbind('click');
        }, function() {
            $(this).parents('tr').click( function() {
                window.location = $(this).attr('data-href');
            });
        });
});


jQuery( function($) {
        $('tbody tr[data-href]').addClass('clickable').click( function() {
            window.location = $(this).attr('data-href');
        }).find('a').hover( function() {
            $(this).parents('tr').unbind('click');
        }, function() {
            $(this).parents('tr').click( function() {
                window.location = $(this).attr('data-href');
            });
        });
});
*/
</script>
</body>
</html>