<html>
<head>
<title>Elenco Commesse</title>
<meta charset="utf-8">
<meta name="description" content="Gestione commesse"> <!--descrizione sintetica viualizzata nei motori di ricerca-->
<meta name="keywords" content="">
<meta name="robots" content="all"> <!--indica allo spider quali pagine indicizzare -->
<meta name="rating" content="general"> <!--decrive il tipo di pubblico (general, mature, restricted, 14years, safe for kids) -->
<meta http-equiv="expires" content="0"> <!--fa scaricare al browser sempre la copia aggiornata-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<link rel="stylesheet" href="css/style.css" type="text/css">
<link rel="stylesheet" href="css/style-container.css" type="text/css">
</head>
<body>
<div class="header">
		<div class="menu-trigger">
				<button type="button" onclick="aprimenu()">Menu</button>
			</div>
		<div class="logo">
		<img src="img/exacta-logo.png" />
	</div>
	<div class="title">
	Gestione Commesse
	</div>
</div>
<div style="clear:both;"></div>
<div class="funzioni">
    <div id="sidebar">
	<div class="menu">
		<a href="index.html">Home</a>
		<a href="commesse.html">Commesse</a>
		<a href="macchine.html">Macchine</a>
		<a href="macchinexcommesse.html">Macchine per commessa</a>
		<a href="pcs.html">Lotti di produzione</a>
		<a href="produzione.html">Produzione</a>
		<a href="impieghi.html">Impieghi</a>
			<a href="impieghixcommessa.html">Impieghi per commessa</a>
</div>
	</div>
    <div id="main"  >
        <div id="content">
	<div class="corpoLista" id="corpoLista" >
		<div class="corpoListaHeader">
			Elenco Commesse
		</div>
		<form id="myForm" action="commesse.php" method="POST"> 
			<div class="lista">
				<table border='2' id='my_table' class='tabella' cellspacing='0' cellpadding='0'>
				<thead>
				<tr>
				<th>ID commessa</th><th>Descrizione</th><th>Data inizio</th><th>Data fine</th><th>Prodotto</th><th>Qta richiesta</th>
				</tr>
				</thead>
					<tbody>
					<!-- IL BODY E' INIZIALMENTE VUOTO -->
					</tbody>
				</table>
			</div>
			<br/>
			<div class="nav">
				<input onclick="pagination('first')" id="exit" type="button" value="<<" />
				<input onclick="pagination('prev')" id="exit" type="button" value="<" />
				<input id="pag" type="number" name="pag" readonly="readonly" value="1" />
				<input onclick="pagination('next')" id="exit" type="button" value=">" />
				<input onclick="pagination('last')" id="exit" type="button" value=">>" />
				<input id="op" type="hidden" name="op" value="list" />
				<input id="nrighe" type="hidden" name="nrighe" value="10" />
			</div>
			<div class="comandi">
				<!--<button onclick="window.location.href='commessa.html'">Nuovo</button>-->
				<div class=allinea>
				<button onclick="invocaNuovo()">Nuovo</button>
				</div>
				<div class=allinea>
				<button onclick="aggiornaLista()">Aggiorna</button>
				</div>
				<div class=allinea>
                <button onclick="invocaFiltro()">Ricerca</button>
				</div>
				<!--<div class=allinea>
                <button onclick="invocaAggiornamentoCommesse()">Aggiornamento Commesse</button>
				</div>-->
				<div class=allinea>
				<a id="cmdReport" href="commesse.php?op=report&pag=1&nrighe=1000&filtro="><img src="img/excel.jpg" width="32px" height="32px" alt="Scarica Report Excel"/></a>
				</div>
			</div>
			<div class="filtro">
				<label id="opFiltroLabel">Filtro:</label>
				<input id="valFiltro" type="text" name="filtro" readonly="readonly" value="" />
            </div>
			<!--<div class="comando2">
				<input id="op2" type="hidden" name="op2" readonly="readonly" value="" />
            </div>-->
		</form>  
		<div class="esito" >
			<span id="resultmyForm"></span>
		</div>
	</div>
<!-- filtro -->
	<div class="corpoFiltro" id="corpoFiltro" style="display:none">
		<div class="corpoFiltroHeader">
		Criteri di ricerca Commesse  
		</div>
		<form id="myFormFiltro" > 
			<div class="record">
				<table>
					<tr>
                        <td>Codice commessa</td>
						<td><select class="operatore" type="text" name="id_order_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
						<td><input type="text" name="id_order" /></td>
					</tr>
					<tr>
					<td>Descrizione</td>
						<td><select class="operatore" type="text" name="descrizione_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="descrizione" /></td>
					</tr>
					<tr>
					<td>Data inizio</td>
						<td><select class="operatore" type="text" name="data_inizio_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="data_inizio" /></td>
					</tr>
					<tr>
					<td>Data fine</td>
						<td><select class="operatore" type="text" name="data_fine_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="data_fine" /></td>
					</tr>
					<tr>
					<td>Prodotto</td>
						<td><select class="operatore" type="text" name="prodotto_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="prodotto" /></td>
					</tr>
					<tr>
					<td>Quantità</td>
						<td><select class="operatore" type="text" name="qta_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="number" name="qta" /></td>
					</tr>
				</table>
			</div>
			<div class="comandi">
				
				<button onclick="applicaFiltro()">Applica</button>
				<button onclick="chiudiFiltro()">Esci</button>
				<input type="reset">
			</div>

		</form>  

	</div>    
<!-- -->    
    <div class="corpoEdit" id="corpoEdit" style="display:none">
		<div class="corpoEditHeader">
		Commessa  
		</div>
		<form id="myFormEdit" action="commesse.php" method="POST"> 
			<div class="record">
				<table>
					<tr>
					<td>Codice commessa</td><td><input type="text" name="id_order" /></td>
					</tr>
					<tr>
					<td>Descrizione</td><td><input type="text" name="descrizione" /></td>
					</tr>
					<tr>
					<td>Data inizio</td><td><input type="text" name="data_inizio" /></td>
					</tr>
					<tr>
					<td>Data fine</td><td><input type="text" name="data_fine" /></td>
					</tr>
					<tr>
					<td>Prodotto</td><td><input type="text" name="prodotto" /></td>
					</tr>
					<tr>
					<td>Quantità</td><td><input type="number" name="qta" /></td>
					</tr>
				</table>
			</div>
			<div class="comandi">
				<input id="submyFormEdit" type="submit" value="Invia" />
				<button onclick="deleteRecord()">Elimina</button>
				<button onclick="cambiaForm()">Esci</button>
			</div>
			<div class="modo">
				<label id="opEditLabel">Modo:</label>
				<input id="opEdit"  type="text" name="op" readonly="readonly" value="insert" />
			</div>
		</form>  
		<div class="esito" >
			<span id="resultmyFormEdit"></span>
		</div>
		<div class="corpoNascosto"style="display:none">
			<form id="myFormHiddenCommesse" action="commesse.php" method="POST">
				<input id="id_order" type="text" name="id_order" value="" />
				<input id="op" type="hidden" name="op" value="get" />
			</form>
		</div>
	</div>
	</div>
	</div>
</div>
<!--<script src="script/jquery-1.12.4.min.js" type="text/javascript"></script>-->
<script type="text/javascript" src="script/jquery-1.9.1.js"></script>
<script src="script/myScript.js" type="text/javascript"></script>
<script type="text/javascript">
	function aprimenu(){
		$("#sidebar").toggle();
		$("#content").css('margin-left','0px');
		nascosto=($('#sidebar').prop('visibility') );// == 'hidden' );
		if (nascosto)
			$("#content").css('margin-left','0px');
		else
			$("#content").css('margin-left','0px');
	};
	</script>
	
<script type='text/javascript'>

function deleteRecord(){
$("#opEdit").val("delete");
	richiestaDati("myFormEdit");

}

function pagination(pagina) {
	npag=parseInt($("#pag").val());
	if (pagina=='first') $("#pag").val(1);
	if (pagina=='last') $("#pag").val(1000);
	if (pagina=='next') $("#pag").val( npag+1);
	if (pagina=='prev') $("#pag").val( npag-1);
	npag=$("#pag").val();
	if (npag<=0) $("#pag").val(1);
	npag=$("#pag").val();
	aggiornaLista();
}


$("#sub").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myForm").submit( function() {
  return false;
});


$("#submyFormEdit").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myFormEdit").submit( function() {
  return false;
});


$("#submyFormFiltro").click( function() {
	return false;
});
 
$("#myFormFiltro").submit( function() {
  return false;
});


function invocaEdit(id){
	$("#id_order").val(id);
	$("#opEdit").val("edit");
	
	cambiaForm();
	richiestaDati("myFormHiddenCommesse");
	
};

function invocaNuovo(){
	$("#id_order").val("");
	$("#opEdit").val("insert");
	
	cambiaForm();
	richiestaDati("myFormHiddenCommesse");
	
};

/*
function invocaAggiornamentoCommesse(){
	$("#op2").val("aggiorna");
	aggiornaLista();
	$("#op2").val("");
};
*/

function aggiornaLista(){
$("#my_table tbody tr:nth-child(n+1)").remove();
	$("#op").val("list");
	richiestaDati("myForm");
	
};
function scaricaReport(){
	$("#op").val("report");
	richiestaDati("myForm");
};


function valutaCriterioFiltro(nomeForm, nomeCampo) {
    criterio="";
    sel="#"+nomeForm+" input[name="+'"'+nomeCampo+'"'+"]";
    valore=$(sel).val();
    if (valore !='' && valore != undefined) {
        sel="#"+nomeForm+" select[name="+'"'+nomeCampo+"_oper"+'"'+"]";
        operatore=$(sel).val();
        criterio=nomeCampo+" "+operatore+" '"+valore+"' ";
    }
    return criterio;
};
    
function valutaFiltro(nomeForm) {
    var nomiCampi = ["id_order","descrizione","data_inizio","data_fine","prodotto","qta"];
	criteri="";
	for (var i=0;i<nomiCampi.length;i++){
		nomeCampo=nomiCampi[i];
		criterio=valutaCriterioFiltro(nomeForm, nomeCampo)
		if (criterio !="") {
			if (criteri !="") criteri=criteri+" and "
			criteri=criteri+criterio;
		}
	}
       
    return criteri;
};
    
function applicaFiltro(){
	criteri=valutaFiltro("myFormFiltro");
    
    chiudiFiltro();
    $("#valFiltro").val(criteri);
	// aggiorna href per download report : 	"produzione.php?op=report&pag=1&nrighe=1000&filtro=''"
	$("a#cmdReport").prop("href","commesse.php?op=report&pag=1&nrighe=1000&filtro="+criteri);
	aggiornaLista();
};

function invocaFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function chiudiFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function cambiaForm(){
            $("#corpoEdit").toggle();
            $("#corpoLista").toggle();

};
$(document).ready(function(){
	richiestaDati("myForm");
});
/*
jQuery( function($) {
        $('tbody tr[data-href]').addClass('clickable').click( function() {
            $("#corpoEdit").toggle();
            $("#corpoLista").toggle();
        }).find('a').hover( function() {
            $(this).parents('tr').unbind('click');
        }, function() {
            $(this).parents('tr').click( function() {
                window.location = $(this).attr('data-href');
            });
        });
});


jQuery( function($) {
        $('tbody tr[data-href]').addClass('clickable').click( function() {
            window.location = $(this).attr('data-href');
        }).find('a').hover( function() {
            $(this).parents('tr').unbind('click');
        }, function() {
            $(this).parents('tr').click( function() {
                window.location = $(this).attr('data-href');
            });
        });
});
*/
</script>
</body>
</html>