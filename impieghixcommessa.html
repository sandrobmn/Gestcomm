<html>
<head>
<title>Produzione totale per OP con Oee</title>
<meta charset="utf-8">
<meta name="description" content="Gestione Avanzamento Produzione"> <!--descrizione sintetica viualizzata nei motori di ricerca-->
<meta name="keywords" content="">
<meta name="robots" content="all"> <!--indica allo spider quali pagine indicizzare -->
<meta name="rating" content="general"> <!--decrive il tipo di pubblico (general, mature, restricted, 14years, safe for kids) -->
<meta http-equiv="expires" content="0"> <!--fa scaricare al browser sempre la copia aggiornata-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<link rel="stylesheet" href="css/style-3.css" type="text/css">
<link rel="stylesheet" href="css/style-container-3.css" type="text/css">
<!--
<link href="http://fonts.googleapis.com/css?family=Bitter&subset=latin" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css/nestedsidemenu.css" />
-->
</head>
<body>
	<div class="grid-container">
			<div class="colonna0" >
				<img class="menu-icon" src="img/back_01.png" onclick="var x = document.getElementById('colonna1');if (x.style.display === 'none') {   x.style.display = 'block'; $('.menu-icon').attr('src','img/back_01.png');} else {x.style.display = 'none'; $('.menu-icon').attr('src','img/forward_01.png');}"/>
			<!--</div>-->
			<div class="colonna1" id="colonna1">
<div class="header">
	<div class="logo">
		<img src="img/exacta-logo.png" />
	</div>
	<div class="title">
	Gestione Avanzamento Produzione
	</div>
</div>
<div style="clear:both;"></div>
<!--<div class="funzioni">-->
	<div id="sidebar">
			<div class="menu nestedsidemenu">
				<!--<div class="closeButton"></div>-->			
				<!--<div class="nestedsidemenu">
					<br style="clear: left" />
				</div>-->
			</div>
	</div>
			<!--<div class="menuButton"></div>-->
	</div>	
	</div>
		<div class="colonna2" id="main">
        <div id="content">
	<div class="corpoLista" id="corpoLista" >
		<div class="corpoListaHeader">
				Produzione totale per OP con Oee
		</div>
		<form id="myForm" action="impieghixcommessa.php" method="POST"> 
				<div class="nav">
						<input onclick="pagination('first')" id="exit" type="button" value="<<" />
						<input onclick="pagination('prev')" id="exit" type="button" value="<" />
						<span id="pagsup" type="text" name="pagsup" readonly="readonly" ></span>
						<input onclick="pagination('next')" id="exit" type="button" value=">" />
						<input onclick="pagination('last')" id="exit" type="button" value=">>" />
					</div>
					<div class="comandi">
							<div class="allinea">
							<button onclick="aggiornaLista()">Aggiorna</button>
							</div>
							<div class="allinea">
							<button onclick="invocaFiltro()">Ricerca</button>
							</div>
							<!--<div class=allinea>
							<button onclick="invocaAggiornamentoCommesse()">Aggiornamento Commesse</button>
							</div>-->
							<div class="allinea">
							<a id="cmdReport" href="impieghixcommessa.php?op=report&pag=1&npag=1&nrighe=1000&filtro=&ordinamento="><img src="img/excel.jpg" width="32px" height="32px" alt="Scarica Report Excel"/></a>
							</div>
						</div>
						<div style="clear:both"></div>
						<div class="lista">
				<table  id='my_table' class='tabella' cellspacing='0' cellpadding='0'>
				<thead>
				<tr>
				<th class="sorting" id="th_id_order" onclick="setOrdinamento('id_order')">ID Lotto</th>
				<th class="sorting" id="th_product" onclick="setOrdinamento('product')">Prodotto</th>
				<th class="sorting" id="th_posizione" onclick="setOrdinamento('posizione')">Macchina</th>
				<th class="sorting" id="th_mind" onclick="setOrdinamento('mind')">Inizio produzione</th>
				<th class="sorting" id="th_maxd" onclick="setOrdinamento('maxd')">Fine produzione</th>
				<th class="sorting" id="th_xxx" onclick="setOrdinamento('toperating_time')">T operativo</th>
				<th class="sorting" id="th_totprod" onclick="setOrdinamento('totprod')">Qta prodotta</th>
				<th class="sorting" id="th_totalpieces" onclick="setOrdinamento('totalpieces')">qta</th>
				<th class="sorting" id="th_total" onclick="setOrdinamento('total')">T totale</th>
				<th class="sorting" id="th_tactive" onclick="setOrdinamento('tactive')">T lavoro</th>
				<th class="sorting" id="th_pactive" onclick="setOrdinamento('pactive')">%</th>
				<th class="sorting" id="th_tidle" onclick="setOrdinamento('tidle')">T inattivo</th>
				<th class="sorting" id="th_pidle" onclick="setOrdinamento('pidle')">%</th>
				<th class="sorting" id="th_talert" onclick="setOrdinamento('talert')">T allarme</th>
				<th class="sorting" id="th_palert" onclick="setOrdinamento('palert')">%</th>
				</tr>
				</thead>
					<tbody>
					<!-- IL BODY E' INIZIALMENTE VUOTO -->
					</tbody>
				</table>
			</div>
			<br/>
			<div class="nav">
				<input onclick="pagination('first')" id="exit" type="button" value="<<" />
				<input onclick="pagination('prev')" id="exit" type="button" value="<" />
				<span id="paginf" type="text" name="paginf" readonly="readonly" ></span>
				<input id="pag" type="hidden" name="pag" readonly="readonly" value="1" />
				<input onclick="pagination('next')" id="exit" type="button" value=">" />
				<input onclick="pagination('last')" id="exit" type="button" value=">>" />
				<input id="op" type="hidden" name="op" value="list" />
				<input id="nrighe" type="hidden" name="nrighe" value="10" />
				<input id="npag" type="hidden" name="npag" value="0" />
				<input id="ordinamento" type="hidden" name="ordinamento" value="" />
			</div>
			<div class="comandi">
				<div class="allinea">
				<button onclick="aggiornaLista()">Aggiorna</button>
				</div>
				<div class="allinea">
                <button onclick="invocaFiltro()">Ricerca</button>
				</div>
				<!--<div class=allinea>
                <button onclick="invocaAggiornamentoCommesse()">Aggiornamento Commesse</button>
				</div>-->
				<div class="allinea">
				<a id="cmdReport" href="impieghixcommessa.php?op=report&pag=1&npag=1&nrighe=1000&filtro=&ordinamento="><img src="img/excel.jpg" width="32px" height="32px" alt="Scarica Report Excel"/></a>
				</div>
			</div>
			<div class="filtro">
				<label id="opFiltroLabel">Filtro:</label>
				<input id="valFiltro" type="text" name="filtro" readonly="readonly" value="" />
            </div>
			<!--<div class="comando2">
				<input id="op2" type="hidden" name="op2" readonly="readonly" value="" />
            </div>-->
		</form>  
		<div class="esito" >
			<span id="resultmyForm"></span>
		</div>
	</div>
<!-- filtro -->
	<div class="corpoFiltro" id="corpoFiltro" style="display:none">
		<div class="corpoFiltroHeader">
		Criteri di ricerca Produzione 
		</div>
		<form id="myFormFiltro" > 
			<div class="record">
				<table>
					<tr>
                        <td>Codice Lotto</td>
						<td><select class="operatore" type="text" name="id_order_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
						<td><input type="text" name="id_order" /></td>
					</tr>
					
					<tr>
					<td>Macchina</td>
						<td><select class="operatore" type="text" name="posizione_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						</select></td>
					<td><input type="text" name="posizione" /></td>
					</tr>
					<!--
					<tr>
					<td>Data inizio prevista</td>
						<td><select class="operatore" type="text" name="planned_start_date_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="planned_start_date" /></td>
					</tr>
					<tr>
					<td>Data fine prevista</td>
						<td><select class="operatore" type="text" name="planned_end_date_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="planned_end_date" /></td>
					</tr>
				-->
					<tr>
					<td>Prodotto</td>
						<td><select class="operatore" type="text" name="product_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="product" /></td>
					</tr>
					<!--
					<tr>
					<td>Quantità richiesta</td>
						<td><select class="operatore" type="text" name="requested_pieces_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="number" name="requested_pieces" /></td>
					</tr>
				-->
					<!--
					<tr>
					<td>Data inizio effettiva</td>
						<td><select class="operatore" type="text" name="mind_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						</select></td>
					<td><input type="text" name="mind" /></td>
					</tr>
					<tr>
					<td>Data fine effettiva</td>
						<td><select class="operatore" type="text" name="maxd_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						</select></td>
					<td><input type="text" name="maxd" /></td>
					</tr>
					-->
					<!--
					<tr>
					<td>Programma</td>
						<td><select class="operatore" type="text" name="CNCprogram_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						<option value="like">like</option>
						</select></td>
					<td><input type="text" name="CNCprogram" /></td>
					</tr>
				-->
					<!--
					<tr>
					<td>Quantità prodotta</td>
						<td><select class="operatore" type="text" name="totprod_oper">
						<option value="=">=</option>
						<option value=">">></option>
						<option value="<"><</option>
						<option value=">=">>=</option>
						<option value="<="><=</option>
						<option value="<>"><></option>
						</select></td>
					<td><input type="number" name="totprod" /></td>
					</tr>
					-->
				</table>
			</div>
			<div class="comandi">
				
					<button onclick="aggiornaLista(aggiornaPrmFiltroExport(applicaFiltro()))">Applica</button>
					<button onclick="chiudiFiltro()">Esci</button>
					<button onClick="this.form.reset();" >Ripristina</button>
				</div>

		</form>  

	</div>    
<!-- -->    
    <div class="corpoEdit" id="corpoEdit" style="display:none">
		<div class="corpoEditHeader">
			Lotto di Produzione  
		</div>
		<form id="myFormEdit" action="commesse.php" method="POST"> 
			<div class="record">
				<table>
					<tr>
					<td>Codice Lotto</td><td><input type="text" name="id_order" /></td>
					</tr>
					<tr>
					<td>Macchina</td><td><input type="text" name="macchina" /></td>
					</tr>
					<tr>
					<td>Data inizio</td><td><input type="text" name="data_inizio" /></td>
					</tr>
					<tr>
					<td>Data fine</td><td><input type="text" name="data_fine" /></td>
					</tr>
					<tr>
					<td>Prodotto</td><td><input type="text" name="prodotto" /></td>
					</tr>
					<tr>
					<td>Quantità</td><td><input type="number" name="qta" /></td>
					</tr>
				</table>
				
			</div>
			<div>
				<canvas id="myChart1" width="300" height="200"></canvas>
				<canvas id="myChart2" width="300" height="150"></canvas>
			</div>
			<div class="comandi">
				<!--<input id="submyFormEdit" type="submit" value="Invia" />
				<button onclick="deleteRecord()">Elimina</button>-->
				<button onclick="cambiaForm()">Esci</button>
			</div>
			<div class="modo">
				<label id="opEditLabel">Modo:</label>
				<input id="opEdit"  type="text" name="op" readonly="readonly" value="insert" />
			</div>
		</form>  
		<div class="esito" >
			<span id="resultmyFormEdit"></span>
		</div>
		<div class="corpoNascosto"style="display:none">
			<form id="myFormHiddenCommesse" action="commesse.php" method="POST">
				<input id="id_order" type="text" name="id_order" value="" />
				<input id="op" type="hidden" name="op" value="get" />
			</form>
		</div>
	</div>
	</div>    
	</div>    
</div>
<!--<script src="script/jquery-1.12.4.min.js" type="text/javascript"></script>-->
<script type="text/javascript" src="script/jquery-1.9.1.js"></script>
<script src="script/myScript.js" type="text/javascript"></script>
<script type="text/javascript" src="script/numberFormat154.js"></script>
<script type="text/javascript" src="script/Chart.js"></script>
<script type="text/javascript">
	
	$(document).ready(function() {
		$('.menuButton').click(function()
		{
			$('#sidebar').animate({"left":"0px"}, 10);
		});
	
		$('.closeButton').click(function()
		{
			$('#sidebar').animate({"left":"-236px"}, 10);
		});
	});
	
// elenco campi per emissione formattata e controllata della lista
elencoCampiLista= {
					 "id_order" : {"caption":"ID Commessa","tipo":"T","sort":""}, 
					 "product" : {"caption":"Prodotto","tipo":"T","sort":""}, 
					 "posizione":{"caption":"Macchina","tipo":"T","sort":""},
					 "mind" : {"caption":"Inizio produzione","tipo":"D","sort":""}, 
					 "maxd" : {"caption":"Fine produzione","tipo":"D","sort":""}, 
					 "toperating_time" : {"caption":"T operativo","tipo":"H","sort":""}, 
					 "totprod" :{"caption": "Qta prodotta","tipo":"N","sort":""}, 
					 "totalpieces" : {"caption":"somma qtaxh","tipo":"N","sort":""}, 
					 "total" : {"caption":"T totale","tipo":"H","sort":""}, 
					 "tactive" : {"caption":"T lavoro","tipo":"H","sort":""}, 
					 "pactive" : {"caption":"%","tipo":"%","sort":""}, 
					 "tidle" : {"caption":"T inattivo","tipo":"H","sort":""}, 
					 "pidle" : {"caption":"%","tipo":"%","sort":""}, 
					 "talert" : {"caption":"T allarme","tipo":"H","sort":""},
					 "palert":{"caption":"%","tipo":"%","sort":""}
				};

		
		
	function caricamento(){
			//------chiudimenu();
		};
	
	</script>
		
	
<script type='text/javascript'>

// grafico
//--var myChart = new Chart({...});


/*
			$campiElenco="id_order, product, mind,maxd,  sum(planned_production_time), sum(operating_time), sum(ideal_operating_time)";
			$campiElenco=$campiElenco.",totprod, sum(total_pieces) as totalpieces, sum(active+idle+alert) as total, sum(active),sum(active)/sum(active+idle+alert) as pactive";
			$campiElenco=$campiElenco.",  sum(idle), sum(idle)/sum(active+idle+alert) as pidle, sum(alert), sum(alert)/sum(active+idle+alert) as palert";
			$campiElenco=$campiElenco.", sum(production), sum(setup), sum(teardown), sum(maintenance), sum(process_development)";
*/
function deleteRecord(){
$("#opEdit").val("delete");
	richiestaDati("myFormEdit");

}



$("#sub").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myForm").submit( function() {
  return false;
});


$("#submyFormEdit").click( function() {
	richiestaDati("myFormEdit");
});
 
$("#myFormEdit").submit( function() {
  return false;
});


$("#submyFormFiltro").click( function() {
	return false;
});
 
$("#myFormFiltro").submit( function() {
  return false;
});

function aggiornaLista(){
$("#my_table tbody tr:nth-child(n+1)").remove();
$("#npag").val(0);
	//$("#op").val("list");
	$("#resultmyForm").html("elaborazione in corso ...");

	richiestaDati("myForm",elencoCampiLista,impostaNpag);
};

function invocaEdit(id){

	
	$("#id_order").val(id);
	$("#opEdit").val("edit");
	
	// trova riga table x id_order=id

	cambiaForm();

	return false;

	richiestaDati("myFormHiddenCommesse");
	
};

function invocaNuovo(){
	$("#id_order").val("");
	$("#opEdit").val("insert");
	
	cambiaForm();
	richiestaDati("myFormHiddenCommesse");
	
};

function scaricaReport(){
	$("#resultmyForm").html("elaborazione in corso ...");

	$("#op").val("report");
	richiestaDati("myForm");
};

function invocaAggiornamentoCommesse(){
	$("#resultmyForm").html("elaborazione in corso ...");
	$("#npag").val(0);
	$("#op").val("updateList");
	aggiornaLista();
	$("#op").val("list");

};




function invocaFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function chiudiFiltro(){
            $("#corpoFiltro").toggle();
            $("#corpoLista").toggle();

};

function cambiaForm(){
            $("#corpoEdit").toggle();
            $("#corpoLista").toggle();

};
$(document).ready(function(){
	
	costruisciMenu();


	
	aggiornaLista();
	
	
});

var myChart = new Array();
myChart["myChart1"] = null;
myChart["myChart2"] = null;

function inizializzaGraficoTempi(myChartId,tipo,tempi,bStacked)
{

if (myChart[myChartId] != null)
	myChart[myChartId].destroy();

var ctx = document.getElementById(myChartId);
if (tipo=="bar" || tipo == 'horizontalBar')
	myChart[myChartId] = new Chart(ctx, {
    'type': tipo,
    'data': {
        'labels': ["Allarme", "Attivo", "Inattivo"],
        'datasets': [
			{
            'label': '',
            'data':tempi,
            'backgroundColor': [
                'rgba(255, 0, 0, 1)',//red
                'rgba(1, 178, 60, 1)',//green
                'rgba(255, 159, 64, 1)'//orange
            ],
            'borderColor': [
                'rgba(255,99,132,1)',
                'rgba(1, 178, 60, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1
        }
		]
    },
    options: {
       title: {
            display: true,
            text: 'T lavorato (ore)'
        },
        scales: {
            xAxes: [{
				stacked:bStacked,
                //display: this.scalesdisplay,
                ticks: {
                    beginAtZero:this.beginzero,
                }
            }],
            yAxes: [{
				stacked:bStacked,
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
});

if (tipo=="pie" || tipo == 'doughnut')
	myChart[myChartId] = new Chart(ctx, {
    'type': tipo,
    'data': {
        'labels': ["Allarme", "Attivo", "Inattivo"],
        'datasets': [{
            'label': '',
            'data':tempi,
            'backgroundColor': [
                'rgba(255, 0, 0, 1)',//red
                'rgba(1, 178, 60, 1)',//green
                'rgba(255, 159, 64, 1)'//orange
             ],
           'hoverBackgroundColor': [
                'rgba(255,99,132,1)',
                'rgba(1, 178, 60, 1)',
                'rgba(255, 159, 64, 1)'
			 ]
            /*'borderColor': [
                'rgba(255,99,132,1)',
                'rgba(75, 192, 192, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1*/
        }]
    },
    options: {
       title: {
            display: true,
            text: 'T lavorato (%)'
        },
		responsive:false,
		maintainAspectRatio:false,
        scales: {
                 xAxes: [{
                        display: this.scalesdisplay,
                        ticks: {
                            beginAtZero:this.beginzero,
                        }
                    }],
                    yAxes: [{
                        display: this.scalesdisplay,
                        ticks: {
                            beginAtZero:this.beginzero,
                        }
                    }]
        }
    }
});


}

function inizializzaGraficoTempi2(myChartId,tipo,tempi,bStacked)
{

if (myChart[myChartId] != null)
	myChart[myChartId].destroy();

var ctx = document.getElementById(myChartId);
if (tipo=="bar" || tipo == 'horizontalBar')
{
	bStackedX=false;
	bStackedY=false;
	if (tipo == 'bar')
		bStackedY=bStacked;
	else
		bStackedX=bStacked;

	myChart[myChartId] = new Chart(ctx, {
    'type': tipo,
    'data': {
        'labels': ["Tempo"],
        'datasets': [
			{
            'label': 'Allarme',
            'data':tempi[0],
            'backgroundColor': [
                'rgba(255, 0, 0, 1)',//red
               // 'rgba(1, 178, 60, 1)',//green
               // 'rgba(255, 159, 64, 1)'//orange
            ],
            'borderColor': [
                'rgba(255,99,132,1)',
                //'rgba(1, 178, 60, 1)',
                //'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1
        }
		,
		{
            'label': 'Attivo',
            'data':tempi[1],
            'backgroundColor': [
                //'rgba(255, 0, 0, 1)',//red
                'rgba(1, 178, 60, 1)',//green
                //'rgba(255, 159, 64, 1)'//orange
            ],
            'borderColor': [
               // 'rgba(255,99,132,1)',
                'rgba(1, 178, 60, 1)',
               // 'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1
        }
		,
{
            'label': 'Inattivo',
            'data':tempi[2],
            'backgroundColor': [
                //'rgba(255, 0, 0, 1)',//red
                //'rgba(1, 178, 60, 1)',//green
                'rgba(255, 159, 64, 1)'//orange
            ],
            'borderColor': [
                //'rgba(255,99,132,1)',
               // 'rgba(1, 178, 60, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1
        }		
		]
    },
    options: {
       title: {
            display: true,
            text: 'T lavorato (ore)'
        },
        scales: {
            xAxes: [{
				stacked:bStackedX,
                //display: this.scalesdisplay,
                ticks: {
                    beginAtZero:this.beginzero,
                }
            }],
            yAxes: [{
				stacked:bStackedY,
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
});
}

if (tipo=="pie" || tipo == 'doughnut')
	myChart[myChartId] = new Chart(ctx, {
    'type': tipo,
    'data': {
        'labels': ["Allarme", "Attivo", "Inattivo"],
        'datasets': [{
            'label': '',
            'data':tempi,
            'backgroundColor': [
                'rgba(255, 0, 0, 1)',//red
                'rgba(1, 178, 60, 1)',//green
                'rgba(255, 159, 64, 1)'//orange
             ],
           'hoverBackgroundColor': [
                'rgba(255,99,132,1)',
                'rgba(1, 178, 60, 1)',
                'rgba(255, 159, 64, 1)'
			 ]
            /*'borderColor': [
                'rgba(255,99,132,1)',
                'rgba(75, 192, 192, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            'borderWidth': 1*/
        }]
    },
    options: {
       title: {
            display: true,
            text: 'T lavorato (%)'
        },
		responsive:false,
		maintainAspectRatio:false,
        scales: {
                 xAxes: [{
                        display: this.scalesdisplay,
                        ticks: {
                            beginAtZero:this.beginzero,
                        }
                    }],
                    yAxes: [{
                        display: this.scalesdisplay,
                        ticks: {
                            beginAtZero:this.beginzero,
                        }
                    }]
        }
    }
});


}

function normalizzaTempi(ttempi){
	for (var i=0;i<ttempi.length;i++)
	{
		svect=ttempi[i].split(":");
		valueTot=0;
		for (j=0;j<svect.length;j++)
		{
			snum=svect[j].trim();
			postFix=snum.substring(snum.length-1);
			value=snum.substring(0,snum.length-1);

			switch(postFix)
			{
				case 'd':
					value=value*24*3600;
				break;
				case 'h':
					value=value*3600;
				break;
				case 'm':
					value=value*60;
				break;
				case 's':
					value=value*1;
				break;
			}
			// tempo orario in secondi
			valueTot += value;
		}
		var v=valueTot/3600;// tempi in ore
		ttempi[i]=v.toFixed(1);

	}
	return (ttempi);
};

function invocaGrafico(idRow){
	

	// scorre i campi della riga
	$("#"+idRow).find("td").each(function(){
		var x=$(this).attr("name");
		var v=$(this).text();
		
		switch(x){
			case "id_order":
				break;
			case "product":
				x="prodotto";
				break;
			case "totprod":
				x="qta";
				break;
			case "maxd":
				x="data_fine";
				break;
			case "mind":
				x="data_inizio";
				break;
			case "posizione":
				x="macchina";
				break;
			case "palert":
				palert=v;
				x="";
				break;
			case "pidle":
				pidle=v;
				x="";
				break;
			case "pactive":
				pactive=v;
				x="";
				break;

			case "sum(alert)":
			case "talert":
				talert=v;
				x="";
				break;
			case "sum(idle)":
			case "tidle":
				tidle=v;
				x="";
				break;
			case "sum(active)":
			case "tactive":
				tactive=v;
				x="";
				break;
			default:
				x="";
			break;
		}
		// compila i campi della form
		if (x>"")
			$("#myFormEdit [name="+x+"]").val(v);
		
	})
	// prepara i campi data
	ptempi = new Array(palert,pactive,pidle);
	ttempi = new Array(talert,tactive,tidle);
	ttempi=normalizzaTempi(ttempi);
	ttempi1=new Array();
	ttempi2=new Array();
	ttempi3=new Array();
	ttempi0=new Array();
	ttempi1[0]=ttempi[0];ttempi2[0]=ttempi[1];ttempi3[0]=ttempi[2];
	ttempi0[0]=ttempi1;ttempi0[1]=ttempi2;ttempi0[2]=ttempi3;
	// inizializza grafico
	inizializzaGraficoTempi("myChart1",'doughnut',ptempi);
	inizializzaGraficoTempi2("myChart2",'horizontalBar',ttempi0,false);
	//inizializzaGraficoTempi("myChart2",'horizontalBar',ttempi,false);

/*
 var lista_td = riga.getElementsByTagName("td");

 for(i=0; i < lista_td.length; i++)
  if(lista_td.item(i).getAttribute(“id”) == “c3”)
   cella = lista_td.item(i);

 // alla fine del ciclo for 
 // cella contiene un riferimento
 // all’elemento con id=”c3″

 alert(cella.getAttribute(“id”))
*/

};

</script>
</body>
</html>